"use strict";var AtomikUIImpl=function(){this.layout={},this.enterAnimations={},this.exitAnimations={},this.initialized=!1,this.exitAnimationTimeout=null,this.canAnimate=!1,this.isAnimating=!1,this.isAnimatingFromMouse=!1,this.clickTAG=null,this.videoFloatContainer=null,this.videoClicked=!1,this.countdownTotalSeconds=0};AtomikUIImpl.prototype.setClickTAG=function(a){this.clickTAG=a},AtomikUIImpl.showAdContainer=function(a){var b=document.getElementById("atomik-ad-container");b.style.visibility=a},AtomikUIImpl.prototype.resizeElements=function(){for(var a=this.layout.targetWidth,b=$(window).width(),c=this.layout.positions,d=0;d<c.length;d++){var e=c[d],f=$(e.target).data("target-width"),g=$(e.target).data("target-height"),h=Math.floor(f*b/a);$(e.target).width(h),$(e.target).height(h*g/f)}},AtomikUIImpl.prototype.positionElements=function(){for(var a=this.layout.positions,b=0;b<a.length;b++){var c=a[b],d=c.anchor;if(d!==void 0){for(var e={position:"absolute",margin:"0"},f=d.split("-"),g=0;g<f.length;g++)"center"===f[g]?(void 0===e.bottom&&(e.bottom=0),void 0===e.top&&(e.top=0),void 0===e.left&&(e.left=0),void 0===e.right&&(e.right=0)):"bottom"===f[g]?(e.bottom=0,e.top=""):"top"===f[g]?(e.top=0,e.bottom=""):"left"===f[g]?(e.left=0,e.right=""):"right"===f[g]&&(e.right=0,e.left="");$(c.target).css(e)}}},AtomikUIImpl.prototype.sizeAndPositionElements=function(){for(var a=this.layout.targetWidth,b=$(window).width(),c=this.layout.positions,d=0;d<c.length;d++){var e=c[d],f=$(e.target).data("target-width"),g=$(e.target).data("target-height"),h=$(e.target).width(),j=Math.floor(f*b/a);$(e.target).width(j),$(e.target).height(j*g/f);var k=parseInt($(e.target).css("bottom"));$(e.target).css({bottom:k*j/h})}},AtomikUIImpl.prototype.setMouserOver=function(){$("#atomik-ad-container").mouseover(function(){atomikUIInst.startAnimation(!0)||null===atomikUIInst.exitAnimationTimeout||(clearTimeout(atomikUIInst.exitAnimationTimeout),atomikUIInst.exitAnimationTimeout=null,atomikUIInst.setMouseLeave())})},AtomikUIImpl.prototype.setMouseLeave=function(){var a=this;$("#atomik-ad-container").mouseleave(function(){$("#atomik-ad-container").off("mouseleave"),null!==a.exitAnimationTimeout&&clearTimeout(a.exitAnimationTimeout),a.exitAnimationTimeout=setTimeout(function(){a.exitAnimationTimeout=null,a.doExitAnimations()},1e3*parseInt(a.exitAnimations.mouseOutDelay))})},AtomikUIImpl.prototype.setPlaceholderAction=function(a){$(".atomik-placeholder").off("click"),$(".atomik-placeholder").click(function(){if(a){var b=null==atomikUIInst.clickTAG?dhtml.getVar("clickTAG","http://www.atomikad.com"):atomikUIInst.clickTAG;var c=dhtml.getVar("landingPageTarget","_blank");window.open(b,c)}else atomikUIInst.startAnimation()})},AtomikUIImpl.prototype.doEnterAnimations=function(){for(var a,b=0,c=0;c<this.enterAnimations.animations.length;c++)if(a=this.enterAnimations.animations[c],void 0!==a.target&&void 0!==a.duration&&void 0!==a.animation){var d=this.createAnimation(a,!0),e=TweenMax.fromTo(a.target,a.duration,d.fromVars,d.toVars),f=0;void 0!==this.enterAnimations.totalDelay&&(f=this.enterAnimations.totalDelay),void 0!==a.delay&&(f+=a.delay),e.delay(f),f+a.duration>b&&(b=f+a.duration)}if(this.setPlaceholderAction(!0),void 0!==this.exitAnimations)if(this.isAnimatingFromMouse&&!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))atomikUIInst.setMouseLeave();else{var g=b;g+=parseInt(this.exitAnimations.totalDelay),null!==this.exitAnimationTimeout&&clearTimeout(this.exitAnimationTimeout),this.exitAnimationTimeout=setTimeout(function(){atomikUIInst.exitAnimationTimeout=null,atomikUIInst.doExitAnimations()},1e3*g)}},AtomikUIImpl.prototype.doExitAnimations=function(){for(var a,b=0,c=0;c<this.exitAnimations.animations.length;c++)if(a=this.exitAnimations.animations[c],void 0!==a.target&&void 0!==a.duration&&void 0!==a.animation){var d=this.createAnimation(a,!1),e=TweenMax.fromTo(a.target,a.duration,d.fromVars,d.toVars),f=0;void 0!==a.delay&&(f+=a.delay),e.delay(f),f+a.duration>b&&(b=f+a.duration)}this.setPlaceholderAction(!1);var g=this;setTimeout(function(){g.isAnimating=!1,!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&atomikUIInst.setMouserOver()},1e3*b)},AtomikUIImpl.prototype.createAnimation=function(a){var b={},c={};if("fadeIn"===a.animation)b={opacity:0},c={opacity:1};else if("fadeOut"===a.animation)b={opacity:1},c={opacity:0,ease:"Quad.easeIn"};else if("fadeInOut"===a.animation)b={opacity:0},c={opacity:1,ease:"Quad.easeIn",yoyo:!0,repeat:1,repeatDelay:a.pause};else if("translateIn"===a.animation||"translateInOut"===a.animation){for(var d,e=0;e<this.layout.positions.length;e++)if(d=this.layout.positions[e],d.target===a.target)if(-1!==d.anchor.indexOf("bottom")){var f=$(a.target).height(),g=0;d.fixedOffset&&(g=f*d.fixedOffset/100),b={css:{bottom:g-f}},c={css:{bottom:0}};break}else if(-1!==d.anchor.indexOf("top")){var f=$(a.target).height();b={css:{top:-f}},c={css:{top:0}};break}else if(-1!==d.anchor.indexOf("left")){var h=$(a.target).width();b={css:{left:-h}},c={css:{left:0}};break}else if(-1!==d.anchor.indexOf("right")){var h=$(a.target).width();b={css:{right:-h}},c={css:{right:0}};break}"translateInOut"===a.animation&&(c.yoyo=!0,c.repeat=1,c.repeatDelay=a.pause)}else if("translateOut"===a.animation){for(var d,e=0;e<this.layout.positions.length;e++)if(d=this.layout.positions[e],d.target===a.target)if(-1!==d.anchor.indexOf("bottom")){var f=$(a.target).height(),g=0;d.fixedOffset&&(g=f*d.fixedOffset/100),b={css:{bottom:0}},c={css:{bottom:g-f},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("top")){var f=$(a.target).height();b={css:{top:0}},c={css:{top:-f},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("left")){var h=$(a.target).width();b={css:{left:0}},c={css:{left:-h},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("right")){var h=$(a.target).width();b={css:{right:0}},c={css:{right:-h},ease:"Quad.easeIn"};break}}else;return a.secondary&&!1!==a.secondary||(c.overwrite="all"),{fromVars:b,toVars:c}},AtomikUIImpl.prototype.startAnimation=function(a){return!!(this.canAnimate&&!0!=this.isAnimating)&&(this.isAnimatingFromMouse=a||!1,this.isAnimating=!0,atomikUIInst.doEnterAnimations(),AtomikUIImpl.showAdContainer("visible"),inBannerVideoPlayerPlay(),!0)},AtomikUIImpl.prototype.createFloatingVideo=function(a,b,c,d,e){if(!this.videoFloatContainer){if(void 0===window.top.videojs)return console.log("ATOMIKSDK - NO VIDEOJS ON PARENT, SEND CLICK INSTEAD!!"),void window.open(b,c);var f=this;f.videoClicked=!1,f.countdownTotalSeconds=d,this.videoFloatContainer=window.top.document.createElement("div");var g=$(this.videoFloatContainer);g.css({position:"fixed",border:"none",margin:0,padding:0,zIndex:1e5,width:"100%",height:"100%",top:0,left:0,backgroundColor:"rgba(255, 255, 255, 0.57)"}),window.top.document.body.appendChild(this.videoFloatContainer);var h,i,j=407,k=g.width(),l=g.height();600>k?(h=k-40,i=h*j/600):(h=600,i=j);var m=window.top.document.createElement("div");$(m).css({position:"absolute",width:h,height:i,left:(k-h)/2,top:(l-i)/2,backgroundColor:"black",overflow:"hidden",cursor:"pointer",boxShadow:"0 10px 20px 0 rgba(0, 0, 0, 0.5), 0 6px 20px 0 rgba(0, 0, 0, 0.3)"}),$(m).attr("id","atomik_overlay_container"),this.videoFloatContainer.appendChild(m);var n=window.top.document.createElement("video");$(n).attr("class","video-js vjs-big-play-centered"),$(n).attr("playsinline","true"),m.appendChild(n);var o=window.top.document.createElement("img");$(o).css({pointerEvents:"none",width:"100%",position:"absolute",bottom:0,left:0}),o.src=e,m.appendChild(o);var p=window.top.document.createElement("div");$(p).css({cursor:"pointer",width:"100%",height:"70px",position:"absolute",bottom:0}),$(p).on("click",function(a){a.stopPropagation(),f.videoClicked=!0,window.open(b,c)}),m.appendChild(p);var q=!0;!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(q=!1);var r=window.top.videojs(n,{sources:a,controlBar:{fullscreenToggle:!1,volumePanel:{inline:!0},progressControl:!1,remainingTimeDisplay:!1},aspectRatio:"16:9",controls:!0,preload:"auto",autoplay:!0,muted:!1});r.on("timeupdate",function(){var a=r.currentTime(),b=f.countdownTotalSeconds-a;0<b?t.innerHTML="Chiudi annuncio in "+Math.ceil(b):(r.off("timeupdate"),t.innerHTML="Chiudi",$(t).on("click",function(a){a.stopPropagation(),f.videoFloatContainer.parentNode.removeChild(f.videoFloatContainer),f.videoFloatContainer=null,inBannerVideoPlayerPlay()}))}),r.on("play",function(){r.controlBar.volumePanel.show(),r.controlBar.volumePanel.volumeControl.show(),r.controlBar.volumePanel.muteToggle.show()}),new Adform.Component.VideoStats(n),inBannerVideoPlayerPause();var s=window.top.document.createElement("div");$(s).css({position:"absolute",top:0,left:0,width:"100%",height:"75%",backgroundColor:"transparent",cursor:"pointer"}),$(s).on("click",function(a){a.stopPropagation(),f.videoClicked=!0,window.open(b,c)}),m.appendChild(s);var t=window.top.document.createElement("div");$(t).css({position:"absolute",right:5,top:5,overflow:"hidden",fontFamily:"Arial",fontSize:12,color:"white",backgroundColor:"rgba(0, 0, 0, 0.4)",padding:10}),m.appendChild(t)}},AtomikUIImpl.prototype.initializeAd=function(){if(!1!==this.initialized){var a=window.top.document.createElement("link");a.rel="stylesheet",a.href="https://vjs.zencdn.net/6.6.3/video-js.css",window.top.document.head.appendChild(a);var b=window.top.document.createElement("script");b.type="text/javascript",b.src="https://vjs.zencdn.net/6.6.3/video.js",window.top.document.head.appendChild(b),this.resizeElements(),this.positionElements(),this.canAnimate=!0;var c=this;$(window).on("resize",function(){c.sizeAndPositionElements()}),!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?atomikUIInst.setMouserOver():atomikUIInst.setPlaceholderAction(!1)}};var atomikUIInst=new AtomikUIImpl,AtomikUI=function(){};AtomikUI.createAd=function(a){atomikUIInst.layout=a.layout,atomikUIInst.enterAnimations=a.enter,atomikUIInst.exitAnimations=a.exit,atomikUIInst.initialized=!0,atomikUIInst.initializeAd()},$(window).on("load",function(){atomikUIInst.canAnimate=!0,atomikUIInst.startAnimation(),$("#close-button").click(function(){if("undefined"!=typeof window.top.atomikInst)for(var a,b="undefined"!=typeof window.parent.external_container,c=0;c<window.top.atomikInst.ads.length;c++)a=window.top.atomikInst.ads[c].adContainer,(window.frameElement.parentElement.parentElement.parentElement===a||b&&window.parent.external_container===a)&&(window.top.atomikInst.ads[c].closed=!0)})});