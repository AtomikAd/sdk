"use strict";var AtomikUIImpl=function(){this.layout={},this.enterAnimations={},this.exitAnimations={},this.initialized=!1,this.exitAnimationTimeout=null,this.canAnimate=!1,this.isAnimating=!1,this.isAnimatingFromMouse=!1,this.clickTAG=null,this.videoFloatContainer=null,this.videoClicked=!1,this.countdownTotalSeconds=0,this.videoHoverTimeout=null,this.videoHoverProgressBar=null};AtomikUIImpl.prototype.setClickTAG=function(a){this.clickTAG=a},AtomikUIImpl.showAdContainer=function(a){var b=document.getElementById("atomik-ad-container");b.style.visibility=a},AtomikUIImpl.prototype.resizeElements=function(){for(var a=this.layout.targetWidth,b=this.layout.targetHeight,c=$(window).width(),d=$(window).height(),e=this.layout.positions,f=0;f<e.length;f++){var g,h,j=e[f],k=$(j.target).data("target-width"),l=$(j.target).data("target-height");!1===$(j.target).hasClass("atomik-frame")?(g=Math.floor(k*c/a),h=g*l/k):c/d<=a/b?(g=Math.floor(k*c/a),h=g*l/k):(h=Math.floor(l*d/b),g=h*k/l),$(j.target).width(g),$(j.target).height(h)}},AtomikUIImpl.prototype.positionElements=function(){for(var a=this.layout.positions,b=0;b<a.length;b++){var c=a[b],d=c.anchor;if(d!==void 0){for(var e={position:"absolute",margin:"0"},f=d.split("-"),g=0;g<f.length;g++)if("center"===f[g]){var h=$(c.target).data("target-y-offset");e.bottom=void 0===h?"50%":"calc(50% + "+h+"%)",e.left="50%",e.marginBottom=-($(c.target).height()/2),e.marginLeft=-($(c.target).width()/2)}else if("bottom"===f[g])e.bottom=0,e.top="";else if("top"===f[g])e.top=0,e.bottom="";else if("left"===f[g])e.left=0,e.right="";else if("right"===f[g])e.right=0,e.left="";else if("inframe"===f[g]){var j=this.layout.targetHeight,k=$(window).height();e.marginBottom=(k-j)/2}$(c.target).css(e)}}},AtomikUIImpl.prototype.sizeAndPositionElements=function(){for(var a=this.layout.targetWidth,b=this.layout.targetHeight,c=$(window).width(),d=$(window).height(),e=this.layout.positions,f=0;f<e.length;f++){var g,h,j=e[f],k=$(j.target).data("target-width"),l=$(j.target).data("target-height"),m=$(j.target).width();!1===$(j.target).hasClass("atomik-frame")?(g=Math.floor(k*c/a),h=g*l/k):c/d<=a/b?(g=Math.floor(k*c/a),h=g*l/k):(h=Math.floor(l*d/b),g=h*k/l),$(j.target).width(g),$(j.target).height(h);var n=j.anchor;if(n&&"center"===n)$(j.target).css({bottom:"50%",left:"50%",marginBottom:-($(j.target).height()/2),marginLeft:-($(j.target).width()/2)});else{var o=parseInt($(j.target).css("bottom")),p=o*g/m;$(j.target).css({bottom:p})}}},AtomikUIImpl.prototype.setVideoMouserOver=function(){var a=this;$(".video-mouse-over").mouseover(function(){null!==a.videoHoverTimeout||(a.videoHoverProgressBar.animate(1,{duration:1500},function(){a.videoHoverProgressBar.set(0)}),a.videoHoverTimeout=setTimeout(function(){a.videoHoverTimeout=null,a.showVideoInFrame()},1500))})},AtomikUIImpl.prototype.setVideoMouseLeave=function(){var a=this;$(".video-mouse-over").mouseleave(function(){null===a.videoHoverTimeout||(a.videoHoverProgressBar.animate(0,{duration:300,easing:"easeOut"}),clearTimeout(a.videoHoverTimeout),a.videoHoverTimeout=null)})},AtomikUIImpl.prototype.setHoverOnPlaceholderVideo=function(){$("#frame-container").css({display:"none"});var a=this;if(!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var b=$("#mouseover-progress").data("progress-bar-width");b===void 0&&(b=3),a.videoHoverProgressBar=new ProgressBar.Line("#mouseover-progress-container",{color:$("#mouseover-progress").data("progress-bar-color"),strokeWidth:b,easing:"linear"}),a.setVideoMouserOver(),a.setVideoMouseLeave()}else $("#cl-area").addClass("over-video")},AtomikUIImpl.prototype.doEnterAnimations=function(){for(var a,b=0,c=0;c<this.enterAnimations.animations.length;c++)if(a=this.enterAnimations.animations[c],void 0!==a.target&&void 0!==a.duration&&void 0!==a.animation){var d=this.createAnimation(a,!0),e=TweenMax.fromTo(a.target,a.duration,d.fromVars,d.toVars),f=0;void 0!==this.enterAnimations.totalDelay&&(f=this.enterAnimations.totalDelay),void 0!==a.delay&&(f+=a.delay),e.delay(f),f+a.duration>b&&(b=f+a.duration)}},AtomikUIImpl.prototype.doExitAnimations=function(){for(var a,b=0,c=0;c<this.exitAnimations.animations.length;c++)if(a=this.exitAnimations.animations[c],void 0!==a.target&&void 0!==a.duration&&void 0!==a.animation){var d=this.createAnimation(a,!1),e=TweenMax.fromTo(a.target,a.duration,d.fromVars,d.toVars),f=0;void 0!==a.delay&&(f+=a.delay),e.delay(f),f+a.duration>b&&(b=f+a.duration)}},AtomikUIImpl.prototype.createAnimation=function(a){var b={},c={};if("fadeIn"===a.animation)b={opacity:0},c={opacity:1};else if("fadeOut"===a.animation)b={opacity:1},c={opacity:0,ease:"Quad.easeIn"};else if("fadeInOut"===a.animation)b={opacity:0},c={opacity:1,ease:"Quad.easeIn",yoyo:!0,repeat:1,repeatDelay:a.pause};else if("translateIn"===a.animation||"translateInOut"===a.animation){for(var d,e=0;e<this.layout.positions.length;e++)if(d=this.layout.positions[e],d.target===a.target)if(-1!==d.anchor.indexOf("bottom")){var f=$(a.target).height(),g=0;d.fixedOffset&&(g=f*d.fixedOffset/100),b={css:{bottom:g-f}},c={css:{bottom:0}};break}else if(-1!==d.anchor.indexOf("top")){var f=$(a.target).height();b={css:{top:-f}},c={css:{top:0}};break}else if(-1!==d.anchor.indexOf("left")){var h=$(a.target).width();b={css:{left:-h}},c={css:{left:0}};break}else if(-1!==d.anchor.indexOf("right")){var h=$(a.target).width();b={css:{right:-h}},c={css:{right:0}};break}"translateInOut"===a.animation&&(c.yoyo=!0,c.repeat=1,c.repeatDelay=a.pause)}else if("translateOut"===a.animation){for(var d,e=0;e<this.layout.positions.length;e++)if(d=this.layout.positions[e],d.target===a.target)if(-1!==d.anchor.indexOf("bottom")){var f=$(a.target).height(),g=0;d.fixedOffset&&(g=f*d.fixedOffset/100),b={css:{bottom:0}},c={css:{bottom:g-f},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("top")){var f=$(a.target).height();b={css:{top:0}},c={css:{top:-f},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("left")){var h=$(a.target).width();b={css:{left:0}},c={css:{left:-h},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("right")){var h=$(a.target).width();b={css:{right:0}},c={css:{right:-h},ease:"Quad.easeIn"};break}}else;return a.secondary&&!1!==a.secondary||(c.overwrite="all"),{fromVars:b,toVars:c}},AtomikUIImpl.prototype.startAnimation=function(a){return!!(this.canAnimate&&!0!=this.isAnimating)&&(this.isAnimatingFromMouse=a||!1,this.isAnimating=!0,atomikUIInst.doEnterAnimations(),AtomikUIImpl.showAdContainer("visible"),inBannerVideoPlayerPlay(),!0)},AtomikUIImpl.prototype.showVideoInFrame=function(){if(!this.videoFloatContainer){dhtml.sendEvent("1","Video Opened");var a=this;a.videoClicked=!1,a.createFrameVideoContainer()}},AtomikUIImpl.prototype.createFrameVideoContainer=function(){if(void 0===window.top.videojs)return console.log("ATOMIKSDK - NO VIDEOJS ON PARENT, SEND CLICK INSTEAD!!"),void window.open(clickTAGvalue,landingpagetarget);var a=getCurrentVideoSources(),b=this;b.videoClicked=!1,this.videoFloatContainer=window.top.document.createElement("div");var c=$(this.videoFloatContainer);c.css({position:"fixed",border:"none",margin:0,padding:0,zIndex:1e5,width:"100%",height:"100%",top:0,left:0,backgroundColor:"rgba(255, 255, 255, 0.57)"}),window.top.document.body.appendChild(this.videoFloatContainer);var d,e,f=407,g=c.width(),h=c.height();g<600?(d=g-40,e=d*f/600):(d=600,e=f);var i=window.top.document.createElement("div");$(i).css({position:"absolute",width:d,height:e,left:(g-d)/2,top:(h-e)/2,backgroundColor:"black",overflow:"hidden",cursor:"pointer",boxShadow:"0 10px 20px 0 rgba(0, 0, 0, 0.5), 0 6px 20px 0 rgba(0, 0, 0, 0.3)"}),$(i).attr("id","atomik_overlay_container"),this.videoFloatContainer.appendChild(i);var j=window.top.document.createElement("video");$(j).attr("class","video-js vjs-big-play-centered"),$(j).attr("playsinline","true"),i.appendChild(j);var k=window.top.document.createElement("img");$(k).css({pointerEvents:"none",width:"100%",position:"absolute",bottom:0}),k.src=companionSrc,i.appendChild(k);var l=window.top.document.createElement("div");$(l).css({cursor:"pointer",width:"100%",height:"70px",position:"absolute",bottom:0}),$(l).on("click",function(a){a.stopPropagation(),b.videoClicked=!0,window.open(clickTAGvalue,landingpagetarget)}),i.appendChild(l);var m=!0;!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(m=!1),console.log(a);var n=window.top.videojs(j,{sources:a,controlBar:{fullscreenToggle:!1,volumePanel:{inline:!0},progressControl:!1,remainingTimeDisplay:!1},aspectRatio:"16:9",controls:!0,preload:"auto",autoplay:!0,muted:!0},function(){n.play()});n.on("timeupdate",function(){var a=n.currentTime(),c=b.countdownTotalSeconds-a;0<c?p.innerHTML="Chiudi annuncio in "+Math.ceil(c):(n.off("timeupdate"),p.innerHTML="Chiudi",$(p).on("click",function(a){a.stopPropagation(),b.videoFloatContainer.parentNode.removeChild(b.videoFloatContainer),b.videoFloatContainer=null,inBannerVideoPlayerPlay()}))}),n.on("play",function(){n.controlBar.volumePanel.show(),n.controlBar.volumePanel.volumeControl.show(),n.controlBar.volumePanel.muteToggle.show()}),new Adform.Component.VideoStats(j),inBannerVideoPlayerPause();var o=window.top.document.createElement("div");$(o).css({position:"absolute",top:0,left:0,width:"100%",height:"75%",backgroundColor:"transparent",cursor:"pointer"}),$(o).on("click",function(a){a.stopPropagation(),b.videoClicked=!0,window.open(clickTAGvalue,landingpagetarget)}),i.appendChild(o);var p=window.top.document.createElement("div");$(p).css({position:"absolute",right:5,top:5,overflow:"hidden",fontFamily:"Arial",fontSize:12,color:"white",backgroundColor:"rgba(0, 0, 0, 0.4)",padding:10}),i.appendChild(p)},AtomikUIImpl.prototype.setCountDown=function(a){var b=this;b.countdownTotalSeconds=a},AtomikUIImpl.prototype.initializeAd=function(){if(!1!==this.initialized){var a=window.top.document.createElement("link");a.rel="stylesheet",a.href="https://vjs.zencdn.net/6.6.3/video-js.css",window.top.document.head.appendChild(a);var b=window.top.document.createElement("script");b.type="text/javascript",b.src="https://vjs.zencdn.net/6.6.3/video.js",window.top.document.head.appendChild(b),this.resizeElements(),this.positionElements(),this.canAnimate=!0;var c=this;$(window).on("resize",function(){c.sizeAndPositionElements()}),this.setHoverOnPlaceholderVideo()}};var atomikUIInst=new AtomikUIImpl,AtomikUI=function(){};AtomikUI.createAd=function(a){atomikUIInst.layout=a.layout,atomikUIInst.enterAnimations=a.enter,atomikUIInst.exitAnimations=a.exit,atomikUIInst.initialized=!0,atomikUIInst.initializeAd()},$(window).on("load",function(){atomikUIInst.canAnimate=!0,atomikUIInst.startAnimation(),$("#close-button").click(function(){if("undefined"!=typeof window.top.atomikInst)for(var a,b="undefined"!=typeof window.parent.external_container,c=0;c<window.top.atomikInst.ads.length;c++)a=window.top.atomikInst.ads[c].adContainer,(window.frameElement.parentElement.parentElement.parentElement===a||b&&window.parent.external_container===a)&&(window.top.atomikInst.ads[c].closed=!0)})});