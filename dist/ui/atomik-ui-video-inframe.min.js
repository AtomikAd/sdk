"use strict";var AtomikUIImpl=function(){this.layout={},this.enterAnimations={},this.exitAnimations={},this.initialized=!1,this.exitAnimationTimeout=null,this.canAnimate=!1,this.isAnimating=!1,this.isAnimatingFromMouse=!1,this.clickTAG=null,this.videoFloatContainer=null,this.videoClicked=!1,this.countdownTotalSeconds=0,this.videoHoverTimeout=null,this.videoHoverProgressBar=null};AtomikUIImpl.prototype.setClickTAG=function(a){this.clickTAG=a},AtomikUIImpl.showAdContainer=function(a){var b=document.getElementById("atomik-ad-container");b.style.visibility=a},AtomikUIImpl.prototype.resizeElements=function(){for(var a=this.layout.targetWidth,b=this.layout.targetHeight,c=$(window).width(),d=$(window).height(),e=this.layout.positions,f=0;f<e.length;f++){var g,h,j=e[f],k=$(j.target).data("target-width"),l=$(j.target).data("target-height");!1===$(j.target).hasClass("atomik-frame")?(g=Math.floor(k*c/a),h=g*l/k):c/d<=a/b?(g=Math.floor(k*c/a),h=g*l/k):(h=Math.floor(l*d/b),g=h*k/l),$(j.target).width(g),$(j.target).height(h)}},AtomikUIImpl.prototype.positionElements=function(){for(var a=this.layout.positions,b=0;b<a.length;b++){var c=a[b],d=c.anchor;if(d!==void 0){for(var e={position:"absolute",margin:"0"},f=d.split("-"),g=0;g<f.length;g++)if("center"===f[g]){var h=$(c.target).data("target-y-offset");e.bottom=void 0===h?"50%":"calc(50% + "+h+"%)",e.left="50%",e.marginBottom=-($(c.target).height()/2),e.marginLeft=-($(c.target).width()/2)}else if("bottom"===f[g])e.bottom=0,e.top="";else if("top"===f[g])e.top=0,e.bottom="";else if("left"===f[g])e.left=0,e.right="";else if("right"===f[g])e.right=0,e.left="";else if("inframe"===f[g]){var j=this.layout.targetHeight,k=$(window).height();e.marginBottom=(k-j)/2}$(c.target).css(e)}}},AtomikUIImpl.prototype.sizeAndPositionElements=function(){for(var a=this.layout.targetWidth,b=this.layout.targetHeight,c=$(window).width(),d=$(window).height(),e=this.layout.positions,f=0;f<e.length;f++){var g,h,j=e[f],k=$(j.target).data("target-width"),l=$(j.target).data("target-height"),m=$(j.target).width();!1===$(j.target).hasClass("atomik-frame")?(g=Math.floor(k*c/a),h=g*l/k):c/d<=a/b?(g=Math.floor(k*c/a),h=g*l/k):(h=Math.floor(l*d/b),g=h*k/l),$(j.target).width(g),$(j.target).height(h);var n=j.anchor;if(n&&"center"===n)$(j.target).css({bottom:"50%",left:"50%",marginBottom:-($(j.target).height()/2),marginLeft:-($(j.target).width()/2)});else{var o=parseInt($(j.target).css("bottom")),p=o*g/m;$(j.target).css({bottom:p})}}},AtomikUIImpl.prototype.setVideoMouserOver=function(){var a=this;$(".video-mouse-over").mouseover(function(){null!==a.videoHoverTimeout||(a.videoHoverProgressBar.animate(1,{duration:1500},function(){a.videoHoverProgressBar.set(0)}),a.videoHoverTimeout=setTimeout(function(){a.videoHoverTimeout=null,a.showVideoInFrame()},1500))})},AtomikUIImpl.prototype.setVideoMouseLeave=function(){var a=this;$(".video-mouse-over").mouseleave(function(){null===a.videoHoverTimeout||(a.videoHoverProgressBar.animate(0,{duration:300,easing:"easeOut"}),clearTimeout(a.videoHoverTimeout),a.videoHoverTimeout=null)})},AtomikUIImpl.prototype.setHoverOnPlaceholderVideo=function(){$("#frame-container").css({display:"none"});var a=this;if(!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var b=$("#mouseover-progress").data("progress-bar-width");b===void 0&&(b=3),a.videoHoverProgressBar=new ProgressBar.Line("#mouseover-progress-container",{color:$("#mouseover-progress").data("progress-bar-color"),strokeWidth:b,easing:"linear"}),a.setVideoMouserOver(),a.setVideoMouseLeave()}else $("#cl-area").addClass("over-video")},AtomikUIImpl.prototype.doEnterAnimations=function(){for(var a,b=0,c=0;c<this.enterAnimations.animations.length;c++)if(a=this.enterAnimations.animations[c],void 0!==a.target&&void 0!==a.duration&&void 0!==a.animation){var d=this.createAnimation(a,!0),e=TweenMax.fromTo(a.target,a.duration,d.fromVars,d.toVars),f=0;void 0!==this.enterAnimations.totalDelay&&(f=this.enterAnimations.totalDelay),void 0!==a.delay&&(f+=a.delay),e.delay(f),f+a.duration>b&&(b=f+a.duration)}},AtomikUIImpl.prototype.doExitAnimations=function(){for(var a,b=0,c=0;c<this.exitAnimations.animations.length;c++)if(a=this.exitAnimations.animations[c],void 0!==a.target&&void 0!==a.duration&&void 0!==a.animation){var d=this.createAnimation(a,!1),e=TweenMax.fromTo(a.target,a.duration,d.fromVars,d.toVars),f=0;void 0!==a.delay&&(f+=a.delay),e.delay(f),f+a.duration>b&&(b=f+a.duration)}},AtomikUIImpl.prototype.createAnimation=function(a){var b={},c={};if("fadeIn"===a.animation)b={opacity:0},c={opacity:1};else if("fadeOut"===a.animation)b={opacity:1},c={opacity:0,ease:"Quad.easeIn"};else if("fadeInOut"===a.animation)b={opacity:0},c={opacity:1,ease:"Quad.easeIn",yoyo:!0,repeat:1,repeatDelay:a.pause};else if("translateIn"===a.animation||"translateInOut"===a.animation){for(var d,e=0;e<this.layout.positions.length;e++)if(d=this.layout.positions[e],d.target===a.target)if(-1!==d.anchor.indexOf("bottom")){var f=$(a.target).height(),g=0;d.fixedOffset&&(g=f*d.fixedOffset/100),b={css:{bottom:g-f}},c={css:{bottom:0}};break}else if(-1!==d.anchor.indexOf("top")){var f=$(a.target).height();b={css:{top:-f}},c={css:{top:0}};break}else if(-1!==d.anchor.indexOf("left")){var h=$(a.target).width();b={css:{left:-h}},c={css:{left:0}};break}else if(-1!==d.anchor.indexOf("right")){var h=$(a.target).width();b={css:{right:-h}},c={css:{right:0}};break}"translateInOut"===a.animation&&(c.yoyo=!0,c.repeat=1,c.repeatDelay=a.pause)}else if("translateOut"===a.animation){for(var d,e=0;e<this.layout.positions.length;e++)if(d=this.layout.positions[e],d.target===a.target)if(-1!==d.anchor.indexOf("bottom")){var f=$(a.target).height(),g=0;d.fixedOffset&&(g=f*d.fixedOffset/100),b={css:{bottom:0}},c={css:{bottom:g-f},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("top")){var f=$(a.target).height();b={css:{top:0}},c={css:{top:-f},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("left")){var h=$(a.target).width();b={css:{left:0}},c={css:{left:-h},ease:"Quad.easeIn"};break}else if(-1!==d.anchor.indexOf("right")){var h=$(a.target).width();b={css:{right:0}},c={css:{right:-h},ease:"Quad.easeIn"};break}}else;return a.secondary&&!1!==a.secondary||(c.overwrite="all"),{fromVars:b,toVars:c}},AtomikUIImpl.prototype.startAnimation=function(a){return!!(this.canAnimate&&!0!=this.isAnimating)&&(this.isAnimatingFromMouse=a||!1,this.isAnimating=!0,atomikUIInst.doEnterAnimations(),AtomikUIImpl.showAdContainer("visible"),inBannerVideoPlayerPlay(),!0)},AtomikUIImpl.prototype.showVideoInFrame=function(){if(!this.videoFloatContainer){dhtml.sendEvent("1","Video Opened");var a=this;a.videoClicked=!1,a.countdownTotalSeconds=dhtml.getVar("atkCountdownVideoSeconds",0),a.doExitAnimations(),TweenMax.fromTo("#frame-container",.5,{opacity:0},{opacity:1,onStart:function(){$("#frame-container").css({display:"block"})},onComplete:function(){a.createFrameVideoContainer()}})}},AtomikUIImpl.prototype.createFrameVideoContainer=function(){var a=this,b=$("#frame-video-container").width(),c=$("#frame-video-container").height(),d=document.createElement("div");$(d).css({position:"relative",width:b,height:c,backgroundColor:"black",overflow:"hidden",cursor:"pointer"}),$("#frame-video-container").append(d),a.videoFloatContainer=d;var e=document.createElement("video");$(e).attr("class","video-js vjs-big-play-centered"),$(e).attr("playsinline","true"),d.appendChild(e);var f=!0;!1===/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(f=!1);var g=getCurrentVideoSources(),h=videojs(e,{sources:g,controlBar:{fullscreenToggle:!1,volumePanel:{inline:!0},progressControl:!1,remainingTimeDisplay:!1},aspectRatio:"16:9",controls:!0,preload:"auto",autoplay:!0,muted:!0});h.on("timeupdate",function(){var b=h.currentTime(),c=a.countdownTotalSeconds-b;0<c?j.innerHTML="Chiudi annuncio in "+Math.ceil(c):(h.off("timeupdate"),j.innerHTML="Chiudi",$(j).on("click",function(b){b.stopPropagation(),a.videoFloatContainer.parentNode.removeChild(a.videoFloatContainer),a.videoFloatContainer=null,inBannerVideoPlayerPlay(),a.doEnterAnimations(),TweenMax.fromTo("#frame-container",.5,{opacity:1},{opacity:0,onComplete:function(){$("#frame-container").css({display:"none"})}})}))}),new Adform.Component.VideoStats(e),inBannerVideoPlayerPause();var i=document.createElement("div");$(i).css({position:"absolute",top:0,left:0,width:"100%",height:"90%",backgroundColor:"transparent",cursor:"pointer"}),$(i).on("click",function(b){b.stopPropagation();a.videoClicked||(a.videoClicked=!0,window.open(clickTAGvalue,landingpagetarget))}),d.appendChild(i);var j=document.createElement("div");$(j).css({position:"absolute",right:5,top:5,overflow:"hidden",fontFamily:"Arial",fontSize:12,color:"white",backgroundColor:"rgba(0, 0, 0, 0.4)",padding:10}),d.appendChild(j)},AtomikUIImpl.prototype.initializeAd=function(){if(!1!==this.initialized){this.resizeElements(),this.positionElements(),this.canAnimate=!0;var a=this;$(window).on("resize",function(){a.sizeAndPositionElements()}),this.setHoverOnPlaceholderVideo()}};var atomikUIInst=new AtomikUIImpl,AtomikUI=function(){};AtomikUI.createAd=function(a){atomikUIInst.layout=a.layout,atomikUIInst.enterAnimations=a.enter,atomikUIInst.exitAnimations=a.exit,atomikUIInst.initialized=!0,atomikUIInst.initializeAd()},$(window).on("load",function(){atomikUIInst.canAnimate=!0,atomikUIInst.startAnimation(),$("#close-button").click(function(){if("undefined"!=typeof window.top.atomikInst)for(var a,b="undefined"!=typeof window.parent.external_container,c=0;c<window.top.atomikInst.ads.length;c++)a=window.top.atomikInst.ads[c].adContainer,(window.frameElement.parentElement.parentElement.parentElement===a||b&&window.parent.external_container===a)&&(window.top.atomikInst.ads[c].closed=!0)})});